{% extends "shared/_base.html" %}

{% block title %}Modifica Esercitazione - TALON{% endblock %}

{% block head %}
<!-- CSS specifico per form -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/attivita/form_attivita.css') }}?v={{ cache_buster }}">
{% endblock %}

{% block content %}
<div class="form-container attivita-form-container" id="modifica-esercitazione-container">
    <div class="form-header">
        <h3>MODIFICA ESERCITAZIONE:</h3>
        <p class="form-subtitle">{{ esercitazione.nome }}</p>
    </div>
    
    <form action="{{ url_for('esercitazioni.modifica_esercitazione', id=esercitazione.id) }}" method="POST" id="form-modifica-esercitazione" class="attivita-form">
        
        <!-- Sezione Dati Principali -->
        <div class="form-section">
            <h4 class="section-title">DATI PRINCIPALI</h4>
            
            <div class="form-group">
                <label for="nome">Nome Esercitazione <span class="required">*</span></label>
                <input type="text" 
                       name="nome" 
                       id="nome" 
                       class="form-control" 
                       required
                       maxlength="255"
                       value="{{ esercitazione.nome }}"
                       placeholder="Inserisci il nome dell'esercitazione">
            </div>

            <div class="form-group">
                <label for="nome_breve">Nome Breve</label>
                <input type="text" 
                       name="nome_breve" 
                       id="nome_breve" 
                       class="form-control" 
                       maxlength="100"
                       value="{{ esercitazione.nome_breve or '' }}"
                       placeholder="Nome abbreviato (opzionale)">
            </div>

            <div class="form-group">
                <label for="anno">Anno</label>
                <input type="number" 
                       name="anno" 
                       id="anno" 
                       class="form-control" 
                       min="2000" 
                       max="2030"
                       value="{{ esercitazione.anno or '' }}"
                       placeholder="Anno dell'esercitazione">
            </div>
        </div>
        
        <!-- Pulsanti azione -->
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Salva Modifiche
            </button>
            <button type="button" class="btn btn-secondary" id="btn-reset">
                <i class="fas fa-undo"></i> Ripristina
            </button>
        </div>
    </form>
    <br>
    <a href="{{ url_for('esercitazioni.lista_esercitazioni') }}" class="cancel-link">Annulla</a>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('form-modifica-esercitazione');
    
    // Salva i valori originali per il ripristino
    const originalValues = {
        nome: document.getElementById('nome').value,
        nome_breve: document.getElementById('nome_breve').value,
        anno: document.getElementById('anno').value
    };
    
    // Pulsante Ripristina
    const btnReset = document.getElementById('btn-reset');
    if (btnReset) {
        btnReset.addEventListener('click', function() {
            if (confirm('Vuoi ripristinare i valori originali?')) {
                document.getElementById('nome').value = originalValues.nome;
                document.getElementById('nome_breve').value = originalValues.nome_breve;
                document.getElementById('anno').value = originalValues.anno;
            }
        });
    }
    
    // Validazione form
    if (form) {
        form.addEventListener('submit', function(e) {
            const nome = document.getElementById('nome').value.trim();
            
            if (!nome) {
                e.preventDefault();
                alert('Il nome dell\'esercitazione Ã¨ obbligatorio');
                document.getElementById('nome').focus();
                return false;
            }
        });
    }
    
    // Auto-focus sul primo campo
    const nomeField = document.getElementById('nome');
    if (nomeField) {
        nomeField.focus();
        nomeField.select();
    }
});
</script>
{% endblock %}