{% extends "_base.html" %}

{% block title %}Elenco Attività - TALON{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/lista_attivita.css') }}">
{% endblock %}

{% block content %}
<div class="detail-header">
    <h3>Elenco Attività</h3>
    <a href="{{ url_for('attivita.inserisci_attivita_form') }}" class="btn-modifica">Nuova Attività</a>
</div>

<div class="list-container">
    <div class="search-bar">
        <input type="search" id="searchInput" placeholder="CERCA PER TIPO, ENTE, OPERAZIONE O DESCRIZIONE...">
    </div>

    <table class="styled-table">
        <thead>
            <tr>
                <th class="sortable" data-column="0">
                    <span class="th-label">Data Inizio</span>
                    <span class="th-arrow" data-arrow="">▲▼</span>
                </th>
                <th class="sortable" data-column="1">
                    <span class="th-label">Tipo Attività</span>
                    <span class="th-arrow" data-arrow="">▲▼</span>
                </th>
                <th class="sortable" data-column="2">
                    <span class="th-label">Ente Svolgimento</span>
                    <span class="th-arrow" data-arrow="">▲▼</span>
                </th>
                <th class="sortable" data-column="3">
                    <span class="th-label">Operazione</span>
                    <span class="th-arrow" data-arrow="">▲▼</span>
                </th>
                <th class="sortable" data-column="4">
                    <span class="th-label">Descrizione</span>
                    <span class="th-arrow" data-arrow="">▲▼</span>
                </th>
            </tr>
        </thead>
        <tbody id="attivitaTableBody">
            {% for attivita in attivita_list %}
            <tr class="clickable-row" data-href="{{ url_for('attivita.visualizza_attivita', id=attivita.id) }}">
                <td>{{ attivita.data_inizio.strftime('%d/%m/%Y') if attivita.data_inizio else '' }}</td>
                <td>{{ attivita.tipologia_nome }}</td>
                <td>{{ attivita.ente_nome }}</td>
                <td>{{ attivita.operazione_nome or 'N/D' }}</td>
                <td>{{ (attivita.descrizione or 'Nessuna descrizione')[:80] }}{% if (attivita.descrizione or '')|length > 80 %}...{% endif %}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" style="text-align: center;">Nessuna attività inserita.</td>
            </tr>
            {% endfor %}
            <tr id="no-results-row" style="display: none;">
                <td colspan="5" style="text-align: center;">Nessun risultato trovato.</td>
            </tr>
        </tbody>
    </table>
</div>

<script src="{{ url_for('static', filename='js/lista_attivita.js') }}"></script>
{% endblock %}